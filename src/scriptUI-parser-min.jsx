// prettier-ignore
var parseScriptUI=function(){function t(){for(var t=-1,n=arguments.length;++t<n;)if(!arguments[t])return!1;return!0}function n(t,n,e){switch(e.length){case 0:return t.call(n);case 1:return t.call(n,e[0]);case 2:return t.call(n,e[0],e[1]);case 3:return t.call(n,e[0],e[1],e[2]);default:return t.apply(n,e)}}function e(t,n){for(var e=-1,r=t.length;++e<r;)n(t[e],e,t)}function r(t,n){for(var e=-1,r=t.length,o=Array(r);++e<r;)o[e]=n(t[e],e,t);return o}function o(t){return A([].slice.call(arguments,1),function(n){if(L(n))for(var e in n)t[e]=n[e]}),t}function i(t,n){n=l(n,t);for(var e=0,r=n.length;null!=t&&e<r;)t=t[U(n[e++])];return e&&e==r?t:void 0}function f(t){return Object.prototype.toString.call(t)}function u(t,n){return a(t,n,function(n,e){return y(t,e)})}function a(t,n,r){var o={};return e(n,function(n){var e=t[n];r(e,n)&&(o[n]=e)}),o}function c(t){if("string"==typeof t)return t;if(x(t))return r(t,c)+"";var n=t+"";return"0"==n&&1/t==-Dn?"-0":n}function l(t,n){if(x(t))return t;return O(t,n)?[t]:B(j(t))}function s(t,n){if(null==n||n<1)return[];for(var e=[],r=0,o=t.length;r<o;)e.push([].slice.call(t,r,r+=n));return e}function h(t){if(!T(t))return t;return x(t)?t.slice():o({},t)}function p(t){var n=x(t)?[]:{};return T(t)&&g(t,function(t,e,r){y(r,e)&&(n[e]=T(t)?p(t):t)}),n}function d(t){return function(){return t}}function b(t,n){for(var e=-1,r=t.length;++e<r;)if(t[e]===n)return!0;return!1}function g(t,n){var r=x(t)?e:A;return r(t,n)}function v(t,n,e){var r=null==t?void 0:t[n];return void 0===r?e:r}function y(t,n){return null!=t&&Object.prototype.hasOwnProperty.call(t,n)}function x(t){return"[object Array]"===f(t)}function k(t){return!0===t||!1===t}function w(t){return"function"==typeof t}function O(t,n){if(x(t))return!1;var e=typeof t;if("number"==e||"boolean"==e||null==t)return!0;return W(Xn.test(t),!En.test(t),null!=n&&t in Object(n))}function S(t){return null==t}function m(t){return null===t}function C(t){return"number"==typeof t}function L(n){var e=typeof n;return t(null!=n,"object"==e||"function"==e)}function T(t){return null!=t&&"object"==typeof t}function I(t){return"string"==typeof t}function P(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e);return n}function F(t,n){var e={};return A(t,function(t,r,o){e[r]=n(t,r,o)}),e}function z(t,n){if(null==t)return{};for(var e={},r=0,o=t.length;r<o;r++)n?e[t[r]]=n[r]:e[t[r][0]]=t[r][1];return e}function A(t,n){e(P(t),function(e){n(t[e],e,t)})}function W(){for(var t=-1,n=arguments.length;++t<n;)if(arguments[t])return!0;return!1}function D(t,n){return r(t,R(n))}function R(t){return function(n){return n[t]}}function B(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(Yn,function(t,e,r,o){n.push(r?o.replace(Bn,"$1"):e||t)}),n}function N(t,n){for(var e=-1,r=Array(t);++e<t;)r[e]=n(e);return r}function U(t){if("string"==typeof t)return t;var n=t+"";return"0"==n&&1/t==-Dn?"-0":n}function j(t){return null==t?"":c(t)}function V(t,n){return delete t[n],t}function E(t){for(var n=P(t),e=n.length,r=new Array(e),o=0;o<e;o++)r[o]=t[n[o]];return r}function X(){for(var t=n(Math.max,null,D(arguments,"length").concat(0)),e=new Array(t),r=0;r<t;r++)e[r]=D(arguments,""+r);return e}function Y(t,e,r,o){var i=_t(r)?H:M;return n(i,null,arguments)}function G(t,e){var r=Qt(t.type)?K:J;o(n(r,null,arguments),It(e))}function M(t,n,e){return o(dn(t,e,Sn(n,e)),It(n))}function J(t,n,e){e=Zn&&jt(e)?"button":e;var r=Vt(e)?dt:bn;return r(t,e,Sn(n,e))}function K(t,n){return gn(t,Pt(n))}function H(t,n,e,r){var i=It(n),f=vn(t,Pt(n));return i.expanded&&r.nodes.push(f),o(f,V(i,"expanded"))}function Q(t,n,e){return xt(n,function(n,r,o,f){var u=i(t,o);i(e,o)(u)&&(f[r]=u)}),n}function Z(t,n,e){g(t,function(r,o){e(r,o,n.concat(o),t),T(r)&&Z(r,n.concat(o),e)})}function _(t,n,e,r,o){A(t,function(t,i){if(i=wt(i).toLowerCase(),!on(i)||!en(n.type,i))return;if(Ut(i)){var f=e(n,t,i,o);_(t,f,e,r,o)}else r(n,t,i)})}function q(t){return v(t,"config")}function tt(t){return v(t,"param")}function nt(t){var n=v(t,"param");return x(n)?hn(n):[]}function et(t){var n=v(t,"style");return L(n)?n:{}}function rt(t,n){var e=Dt(t,n),r=new kt;return _(t,e,Y,G,r),St(r.nodes),e}function ot(t,n,e,r){var o=rt(t,n);return Wt(o,r),un(o)&&e&&o.show(),o}function it(t,n,e,r){var o=null;return function(){return Kt(o)&&(o=rt(t,n)),Wt(o,r),un(o)&&e&&o.show(),o}}function ft(t){var e=t?it:ot;return n(e,null,[].slice.call(arguments,1))}function ut(){var t=this.graphics.measureString(this.text,this.font),n=this.graphics.measureString(this.text,this.font,t[0]),e=Jn?mt(n[0],this.text):n[0],r=(this.width-e)/2+this.left+this.fontOffset[0],o=_n?ne:(this.height-n[1])/2+this.top+this.fontOffset[1];return[r+$e[0],o+$e[1]]}function at(t){return ScriptUI.newFont(t.fontName,ln(t.fontStyle),t.fontSize)}function ct(t,e){var o=r(e,function(e){return n(yn,t,e)});return z(we,o)}function lt(t,n,e){var r=Ct(e,n);S(r)&&(r={});var i=v(e,1,Ve.bounds),f=v(e,2,Ve.text),a={text:f,properties:{name:r.name}},c=t.add(st(n,a),i),l=o(u(r,xe),{bounds:i,text:f});return l=Q(sn(l),p(Ye),Me),gt(c,n,l)}function st(t,n){return an(t)+pt(n)}function ht(t,n,e){var r=Ct(e,n);S(r)&&(r={});var i=v(e,1,Ee.bounds),f=v(e,2,Ee.text),a={text:f,properties:{name:r.name}},c=t.add(st(n,a),i),l=o(u(r,ke),{bounds:i,text:f});return l=Q(sn(l),p(Ge),Je),gt(c,n,l)}function pt(t){return Ot(uneval(t))}function dt(t,n,e){var r={rectbutton:lt,roundbutton:ht};return r[n](t,n,e)}function bt(t,n){var e=t.graphics,r="rectbutton"===n?"rectPath":"ellipsePath",o="rectbutton"===n?vt:yt;return t.onDraw=function(){var n=new o(t);e[r](n.left,n.top,n.width,n.height),n.enableFill&&e.fillPath(n.pen.fill),n.enableStroke&&e.strokePath(n.pen.stroke),n.enableText&&e.drawString(n.text,n.pen.text,n.textX,n.textY,n.font)},t}function gt(t,n,e){var r=t.graphics,i=ct(r,pn(e)),f=at(cn(e));return o(r,u(e,Oe),{pen:i.mouseout,font:f}),bt(Tn(In(t,i)),n)}function vt(t){this.graphics=t.graphics,this.enableText=this.graphics.enableText,this.enableFill=this.graphics.enableFill,this.enableStroke=this.graphics.enableStroke,this.fontOffset=this.graphics.fontOffset,this.pen=this.graphics.pen,this.text=t.text,this.font=this.graphics.font,this.left=0,this.top=0,this.width=t.size[0]-te,this.height=t.size[1]-te,this.textLocation=ut.call(this),this.textX=this.textLocation[0],this.textY=this.textLocation[1]}function yt(t){this.graphics=t.graphics,this.enableText=this.graphics.enableText,this.enableFill=this.graphics.enableFill,this.enableStroke=this.graphics.enableStroke,this.fontOffset=this.graphics.fontOffset,this.pen=this.graphics.pen,this.text=t.text,this.font=this.graphics.font,this.left=this.pen.stroke.lineWidth,this.top=this.pen.stroke.lineWidth,this.width=t.size[0]-2*this.left-te,this.height=t.size[1]-2*this.top-te,this.textLocation=ut.call(this),this.textX=this.textLocation[0],this.textY=this.textLocation[1]}function xt(t,e){Z(t,[],function(t){T(t)||n(e,null,arguments)})}function kt(){this.nodes=[]}function wt(t){return t.replace(Rn,"")}function Ot(t){return t.replace(Nn,"")}function St(t){e(t,function(t){t.expanded=!0})}function mt(t,n){var e=n.length;return t/((e+ee)/e)}function Ct(t,n){return t[Lt(n)]}function Lt(t){if(Zt(t))return ue[t];if(Vt(t))return ce[t];if(Ut(t))return ae[t]}function Tt(t){return x(t)?hn(t):nt(t)}function It(t){return x(t)?{}:et(t)}function Pt(t){var n=L(t)?tt(t):t;return String(n)}function $t(t,n){return qt(n)?n:new Window(t[0],t[1],t[2],t[3])}function Ft(t){return r(zt(t),function(t){return t/255})}function zt(t){var n;return t=t.replace(jn,"$1$1$2$2$3$3"),t.replace(Vn,function(t,e,r,o){n=[parseInt(e,16),parseInt(r,16),parseInt(o,16)]}),n}function At(t,n){return Ft(t).concat(n)}function Wt(t,n){t.layout.layout(n),t.layout.resize()}function Dt(t,n){var e=$t(Pn(nt(t)),n);return e.onResizing=e.onResize=xn,o(e,et(t))}function Rt(t){return parseInt(zn.appVersion)===t}function Bt(t,n){return function(e){return C(e)&&e>=t&&e<=n}}function Nt(t){return null!=t&&"[object BridgeTalk]"===f(t)}function Ut(t){return se.test(ge[t])}function jt(t){return de.test(ge[t])}function Vt(t){return pe.test(ge[t])}function Et(t){return W(Bt(0,3)(t),I(t)&&Un.test(t))}function Xt(t){return t===Fn}function Yt(t){return null!=t&&"[object global]"===f(t)}function Gt(t){return null!=t&&"[object $]"===f(t)}function Mt(t){return I(t)&&Vn.test(t)}function Jt(t){return Gn===t}function Kt(t){return null===t||!t.visible}function Ht(t){return t.button===ve}function Qt(t){return he.test(ge[t])}function Zt(t){return be.test(ge[t])}function _t(t){return"node"===t}function qt(t){return t instanceof Panel}function tn(t){return qt(t)}function nn(t){return t.button===ye}function en(t,n){var e=ge[t]+ge[n];return le.test(e)}function rn(t){return Xt(t)||tn(t)}function on(t){return y(ge,t)}function fn(t,n){return!!t&&b(n,t.appName)}function un(t){return t instanceof Window}function an(t){return Le[t]}function cn(t){return u(t,me)}function ln(t){return I(t)?ScriptUI.FontStyle[t.toUpperCase()]:t}function sn(t){return F(t,function(t,n){return b(Se,n)&&!x(t)?N(4,d(t)):t})}function hn(t){return r(t,function(t){return m(t)?void 0:t})}function pn(t){return r(n(X,null,E(u(t,Ce))),function(t){var e=s(t,3),o=X(e[0],e[1]),i=r(o,function(t){return n(At,null,t)});return i.concat(e[2])})}function dn(t,n,e){return t.add(n,e[1],e[2],e[3])}function bn(t,n,e){return t.add(n,e[1],e[2],e[3],e[4],e[5])}function gn(t,n){return t.add("item",n)}function vn(t,n){return t.add("node",n)}function yn(t,n,e,r){return{text:this.newPen(this.PenType.SOLID_COLOR,t,1),fill:this.newBrush(this.BrushType.SOLID_COLOR,n),stroke:this.newPen(this.PenType.SOLID_COLOR,e,r)}}function xn(){this.layout.resize()}function kn(t){if(!L(t))return null;var e=n(ft,null,wn(t,kn));return qn.push(e),e}function wn(t,n){var e=o(h(Xe),q(t)),r=!!e.show,i=!!e.dockable,f=!!e.singleton,u=On(n.context,i,f),a=mn(n.layoutMode,e.layoutMode);return[f,t,u,r,a]}function On(t,n,e){if(e||!n)return Window;if(rn($n))return $n;return rn(t)?t:Window}function Sn(t,n){return Ln(Tt(t),n)}function mn(t,n){if(Bt(0,2)(n))return n;if(Bt(0,2)(t))return t;return 0}function Cn(t,n){e(we,function(e){t.addEventListener(e,n)})}function Ln(t,n){var e=t[0];if(S(e))return t;var r=Lt(n),o=t[r];if(L(o)||(t[r]={}),y(o,"name"))return t;return t[r].name=e,t}function Tn(t){return t.addEventListener("mouseup",function(n){n.stopPropagation(),w(t.onClick)&&Ht(n)&&t.onClick()}),t}function In(t,n){return Cn(t,function(e){if(e.stopPropagation(),nn(e))return;t.graphics.pen=n[e.type],t.notify("onDraw")}),t}function Pn(t){var n=String(t[0]);return t[0]=b(oe,n)?n:fe,t}var $n=this,Fn=Gt($)&&Yt($.global)&&$.global,zn=!!Fn&&Nt(Fn.BridgeTalk)&&Fn.BridgeTalk,An=["aftereffects","photoshop","illustrator","indesign","estoolkit"];if(!fn(zn,An))throw"不受支持的宿主应用";var Wn="0.2.5",Dn=1/0,Rn=/\d/g,Bn=/\\(\\)?/g,Nn=/\)$|^\(/g,Un=/REGULAR|BOLD|ITALIC|BOLDITALIC/i,jn=/^#?([a-f\d])([a-f\d])([a-f\d])$/gi,Vn=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/gi,En=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Xn=/^\w*$/,Yn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gn=zn.appName,Mn=Jt("aftereffects"),Jn=Jt("photoshop"),Kn=Jt("illustrator"),Hn=Jt("indesign"),Qn=Jt("estoolkit"),Zn=Mn&&Rt(16),_n=Kn||Hn,qn=[],te=Jn?1:0,ne=Kn?4.5:5,ee=2.4,re={aftereffects:["dialog","palette","window"],photoshop:"dialog",illustrator:["dialog","palette","window"],indesign:"dialog",estoolkit:["dialog","palette","window"]},oe=re[Gn],ie={aftereffects:"palette",photoshop:"dialog",illustrator:"palette",indesign:"dialog",estoolkit:"palette"},fe=ie[Gn],ue={button:3,checkbox:3,dropdownlist:3,edittext:3,iconbutton:3,image:3,listbox:3,progressbar:5,radiobutton:3,scrollbar:5,slider:5,statictext:3,treeview:3},ae={group:2,panel:3,tab:3,tabbedpanel:3},ce={rectbutton:3,roundbutton:3,angle:3},le=/[CGMNTW][ABDEFGHIKNOPQRSUVXYZ]|DJ|V[JL]|L[LJ]|UT/,se=/[GLNTUV]/,he=/[DKLV]/,pe=/[XYZ]/,de=/[XY]/,be=/[ABDEFHIKOPQRS]/,ge={button:"A",checkbox:"B",dialog:"C",dropdownlist:"D",edittext:"E",group:"G",iconbutton:"H",image:"I",item:"J",listbox:"K",node:"L",palette:"M",panel:"N",progressbar:"O",radiobutton:"P",scrollbar:"Q",slider:"R",statictext:"S",tab:"T",tabbedpanel:"U",treeview:"V",window:"W",rectbutton:"X",roundbutton:"Y",angle:"Z"};Qn&&o(ge,{flashplayer:"F"}),Jn&&V(ge,"treeview");var ve=0,ye=2,xe=["enableText","enableFill","enableStroke","fontName","fontStyle","fontSize","fontOffset","fontColor","fillColor","strokeColor","fontOpacity","fillOpacity","strokeOpacity","strokeWidth"],ke=xe,we=["mouseover","mouseout","mousedown","mouseup"],Oe=["enableText","enableFill","enableStroke","fontOffset"],Se=["fontColor","fillColor","strokeColor","fontOpacity","fillOpacity","strokeOpacity","strokeWidth"],me=["fontName","fontStyle","fontSize"],Ce=["fontColor","fillColor","strokeColor","fontOpacity","fillOpacity","strokeOpacity","strokeWidth"],Le={rectbutton:"customView",roundbutton:"customView",angle:"customBoundedValue"},Te={aftereffects:2,photoshop:1,illustrator:2,indesign:2,estoolkit:2},Ie=N(4,d(Te[Gn])),Pe={aftereffects:[0,0],photoshop:[0,0],illustrator:[0,2],indesign:[0,3],estoolkit:[0,-1]},$e=Pe[Gn],Fe={aftereffects:["#161616","#8a8a8a","#161616","#ffffff"],photoshop:["#f0f0f0","#f0f0f0","#f0f0f0","#ffffff"],illustrator:["#4b4b4b","#ffffff","#ffffff","#ffffff"],indesign:["#4b4b4b","#ffffff","#ffffff","#ffffff"],estoolkit:["#000000","#000000","#000000","#000000"]},ze=Fe[Gn],Ae={aftereffects:["#8a8a8a","#232323","#636363","#2d8ceb"],photoshop:["#454545","#454545","#363636","#454545"],illustrator:["#ffffff","#535353","#46a0f5","#46a0f5"],indesign:["#ffffff","#535353","#46a0f5","#46a0f5"],estoolkit:["#e5f1fb","#e1e1e1","#cce4f7","#e5f1fb"]},We=Ae[Gn],De={aftereffects:["#8a8a8a","#8a8a8a","#636363","#2d8ceb"],photoshop:["#666666","#666666","#636363","#1473e7"],illustrator:["#ffffff","#ffffff","#46a0f5","#46a0f5"],indesign:["#ffffff","#ffffff","#46a0f5","#46a0f5"],estoolkit:["#0078d7","#adadad","#005499","#0078d7"]},Re=De[Gn],Be={aftereffects:[0,0,80,28],photoshop:[0,0,65,25],illustrator:[0,0,80,26],indesign:[0,0,80,28],estoolkit:[0,0,78,23]},Ne=Be[Gn],Ue={aftereffects:[0,0,30,30],photoshop:[0,0,28,28],illustrator:[0,0,28,28],indesign:[0,0,30,30],estoolkit:[0,0,23,23]},je=Ue[Gn],Ve={text:"",bounds:Ne},Ee={text:"",bounds:je},Xe={dockable:!0,show:!0,singleton:!1},Ye={enableText:!0,enableFill:!0,enableStroke:!0,fontName:"Tahoma",fontStyle:"REGULAR",fontSize:12,fontOffset:[0,0],fontColor:ze,fillColor:We,strokeColor:Re,fontOpacity:[1,1,1,1],fillOpacity:[1,1,1,1],strokeOpacity:[1,1,1,1],strokeWidth:Ie},Ge=Ye,Me={enableText:k,enableFill:k,enableStroke:k,fontName:I,fontStyle:Et,fontSize:Bt(1,24),fontOffset:[C,C],fontColor:[Mt,Mt,Mt,Mt],fillColor:[Mt,Mt,Mt,Mt],strokeColor:[Mt,Mt,Mt,Mt],fontOpacity:[Bt(0,1),Bt(0,1),Bt(0,1),Bt(0,1)],fillOpacity:[Bt(0,1),Bt(0,1),Bt(0,1),Bt(0,1)],strokeOpacity:[Bt(0,1),Bt(0,1),Bt(0,1),Bt(0,1)],strokeWidth:[Bt(0,10),Bt(0,10),Bt(0,10),Bt(0,10)]},Je=Me;return kn.version=Wn,kn}.call(this);
