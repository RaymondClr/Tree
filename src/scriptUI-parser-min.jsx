// prettier-ignore
var parseScriptUI=function(){function t(){for(var t=-1,n=arguments.length;++t<n;)if(!arguments[t])return!1;return!0}function n(t,n,e){switch(e.length){case 0:return t.call(n);case 1:return t.call(n,e[0]);case 2:return t.call(n,e[0],e[1]);case 3:return t.call(n,e[0],e[1],e[2]);default:return t.apply(n,e)}}function e(t,n){for(var e=-1,r=t.length;++e<r;)n(t[e],e,t)}function r(t,n){for(var e=-1,r=t.length,o=Array(r);++e<r;)o[e]=n(t[e],e,t);return o}function o(t){return W([].slice.call(arguments,1),function(n){if(L(n))for(var e in n)t[e]=n[e]}),t}function i(t,n){n=l(n,t);for(var e=0,r=n.length;null!=t&&e<r;)t=t[N(n[e++])];return e&&e==r?t:void 0}function f(t){return Object.prototype.toString.call(t)}function u(t,n){return a(t,n,function(n,e){return y(t,e)})}function a(t,n,r){var o={};return e(n,function(n){var e=t[n];r(e,n)&&(o[n]=e)}),o}function c(t){if("string"==typeof t)return t;if(x(t))return r(t,c)+"";var n=t+"";return"0"==n&&1/t==-Qn?"-0":n}function l(t,n){if(x(t))return t;return O(t,n)?[t]:B(U(t))}function s(t,n){if(null==n||n<1)return[];for(var e=[],r=0,o=t.length;r<o;)e.push([].slice.call(t,r,r+=n));return e}function h(t){if(!T(t))return t;return x(t)?t.slice():o({},t)}function p(t){var n=x(t)?[]:{};return T(t)&&g(t,function(t,e,r){y(r,e)&&(n[e]=T(t)?p(t):t)}),n}function d(t){return function(){return t}}function b(t,n){for(var e=-1,r=t.length;++e<r;)if(t[e]===n)return!0;return!1}function g(t,n){var r=x(t)?e:W;return r(t,n)}function v(t,n,e){var r=null==t?void 0:t[n];return void 0===r?e:r}function y(t,n){return null!=t&&Object.prototype.hasOwnProperty.call(t,n)}function x(t){return"[object Array]"===f(t)}function k(t){return!0===t||!1===t}function w(t){return"function"==typeof t}function O(t,n){if(x(t))return!1;var e=typeof t;if("number"==e||"boolean"==e||null==t)return!0;return A(fe.test(t),!ie.test(t),null!=n&&t in Object(n))}function m(t){return null==t}function S(t){return null===t}function C(t){return"number"==typeof t}function L(n){var e=typeof n;return t(null!=n,"object"==e||"function"==e)}function T(t){return null!=t&&"object"==typeof t}function I(t){return"string"==typeof t}function z(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e);return n}function P(t,n){var e={};return W(t,function(t,r,o){e[r]=n(t,r,o)}),e}function F(t,n){if(null==t)return{};for(var e={},r=0,o=t.length;r<o;r++)n?e[t[r]]=n[r]:e[t[r][0]]=t[r][1];return e}function W(t,n){e(z(t),function(e){n(t[e],e,t)})}function A(){for(var t=-1,n=arguments.length;++t<n;)if(arguments[t])return!0;return!1}function j(t,n){return r(t,R(n))}function R(t){return function(n){return n[t]}}function B(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(ue,function(t,e,r,o){n.push(r?o.replace(te,"$1"):e||t)}),n}function D(t,n){for(var e=-1,r=Array(t);++e<t;)r[e]=n(e);return r}function N(t){if("string"==typeof t)return t;var n=t+"";return"0"==n&&1/t==-Qn?"-0":n}function U(t){return null==t?"":c(t)}function E(t,n){return delete t[n],t}function V(t){for(var n=z(t),e=n.length,r=new Array(e),o=0;o<e;o++)r[o]=t[n[o]];return r}function M(){for(var t=n(Math.max,null,j(arguments,"length").concat(0)),e=new Array(t),r=0;r<t;r++)e[r]=j(arguments,""+r);return e}function X(t,e,r,o){var i=un(r)?q:_;return n(i,null,arguments)}function Y(t,e){var r=en(t.type)?H:G;o(n(r,null,arguments),$t(e))}function _(t,n,e){return o(Pn(t,e,Un(n,e)),$t(n))}function G(t,n,e){e=de&&Et(e)?"button":e;var r=Vt(e)?dt:Fn;return r(t,e,Un(n,e))}function q(t,n,e,r){var i=$t(n),f=An(t,zt(n));return i.expanded&&r.nodes.push(f),o(f,E(i,"expanded"))}function H(t,n){return Wn(t,zt(n))}function J(t,n,e){return xt(n,function(n,r,o,f){var u=i(t,o);i(e,o)(u)&&(f[r]=u)}),n}function K(t,n,e){g(t,function(r,o){e(r,o,n.concat(o),t),T(r)&&K(r,n.concat(o),e)})}function Q(t,n,e,r,o){W(t,function(t,i){if(i=wt(i).toLowerCase(),!kn(i)||!vn(n.type,i))return;if(Nt(i)){var f=e(n,t,i,o);Q(t,f,e,r,o)}else r(n,t,i)})}function Z(t){return v(t,"config")}function tt(t){return v(t,"param")}function nt(t){var n=v(t,"param");return x(n)?In(n):[]}function et(t){var n=v(t,"style");return L(n)?n:{}}function rt(t,n){var e=jt(t,n),r=new kt;return Q(t,e,X,Y,r),mt(r.nodes),e}function ot(t,n,e,r){var o=rt(t,n);return At(o,r),Sn(o)&&e&&o.show(),o}function it(t,n,e,r){var o=null;return function(){return Qt(o)&&(o=rt(t,n)),At(o,r),Sn(o)&&e&&o.show(),o}}function ft(t){var e=t?it:ot;return n(e,null,[].slice.call(arguments,1))}function ut(){var t=this.graphics.measureString(this.text,this.font),n=this.graphics.measureString(this.text,this.font,t[0]),e=le?St(n[0],this.text):n[0],r=(this.width-e)/2+this.left+this.fontOffset[0],o=be?ye:(this.height-n[1])/2+this.top+this.fontOffset[1];return[r+Ve[0],o+Ve[1]]}function at(t){return ScriptUI.newFont(t.fontName,Tn(t.fontStyle),t.fontSize)}function ct(t,e){var o=r(e,function(e){return n(jn,t,e)});return F(Fe,o)}function lt(t,n,e){var r=Ct(e,n);m(r)&&(r={});var i=v(e,1,Ze.bounds),f=v(e,2,Ze.text),a={text:f,properties:{name:r.name}},c=t.add(st(n,a),i),l=o(u(r,ze),{bounds:i,text:f});return l=J($n(l),p(er),or),gt(c,n,l)}function st(t,n){return Cn(t)+pt(n)}function ht(t,n,e){var r=Ct(e,n);m(r)&&(r={});var i=v(e,1,tr.bounds),f=v(e,2,tr.text),a={text:f,properties:{name:r.name}},c=t.add(st(n,a),i),l=o(u(r,Pe),{bounds:i,text:f});return l=J($n(l),p(rr),ir),gt(c,n,l)}function pt(t){return Ot(uneval(t))}function dt(t,n,e){var r={rectbutton:lt,roundbutton:ht};return r[n](t,n,e)}function bt(t,n){var e=t.graphics,r="rectbutton"===n?"rectPath":"ellipsePath",o="rectbutton"===n?vt:yt;return t.onDraw=function(){var n=new o(t);e[r](n.left,n.top,n.width,n.height),n.enableFill&&e.fillPath(n.pen.fill),n.enableStroke&&e.strokePath(n.pen.stroke),n.enableText&&e.drawString(n.text,n.pen.text,n.textX,n.textY,n.font)},t}function gt(t,n,e){var r=t.graphics,i=ct(r,zn(e)),f=at(Ln(e));return o(r,u(e,Ae),{pen:i.mouseout,font:f}),bt(Xn(Yn(t,i)),n)}function vt(t){this.graphics=t.graphics,this.enableText=this.graphics.enableText,this.enableFill=this.graphics.enableFill,this.enableStroke=this.graphics.enableStroke,this.fontOffset=this.graphics.fontOffset,this.pen=this.graphics.pen,this.text=t.text,this.font=this.graphics.font,this.left=0,this.top=0,this.width=t.size[0]-ve,this.height=t.size[1]-ve,this.textLocation=ut.call(this),this.textX=this.textLocation[0],this.textY=this.textLocation[1]}function yt(t){this.graphics=t.graphics,this.enableText=this.graphics.enableText,this.enableFill=this.graphics.enableFill,this.enableStroke=this.graphics.enableStroke,this.fontOffset=this.graphics.fontOffset,this.pen=this.graphics.pen,this.text=t.text,this.font=this.graphics.font,this.left=this.pen.stroke.lineWidth,this.top=this.pen.stroke.lineWidth,this.width=t.size[0]-2*this.left-ve,this.height=t.size[1]-2*this.top-ve,this.textLocation=ut.call(this),this.textX=this.textLocation[0],this.textY=this.textLocation[1]}function xt(t,e){K(t,[],function(t){T(t)||n(e,null,arguments)})}function kt(){this.nodes=[]}function wt(t){return t.replace(Zn,"")}function Ot(t){return t.replace(ne,"")}function mt(t){e(t,function(t){t.expanded=!0})}function St(t,n){var e=n.length;return t/((e+xe)/e)}function Ct(t,n){return t[Lt(n)]}function Lt(t){if(fn(t))return Ce[t];if(Vt(t))return Te[t];if(Nt(t))return Le[t]}function Tt(t){return x(t)?In(t):nt(t)}function $t(t){return x(t)?{}:et(t)}function It(t,n){return cn(n)?n:new Window(t[0],t[1],t[2],t[3])}function zt(t){var n=L(t)?tt(t):t;return String(n)}function Pt(t){return r(Ft(t),function(t){return t/255})}function Ft(t){var n;return t=t.replace(re,"$1$1$2$2$3$3"),t.replace(oe,function(t,e,r,o){n=[parseInt(e,16),parseInt(r,16),parseInt(o,16)]}),n}function Wt(t,n){return Pt(t).concat(n)}function At(t,n){t.layout.layout(n),t.layout.resize()}function jt(t,n){var e=It(_n(nt(t)),n);return e.onResizing=e.onResize=Rn,o(e,et(t))}function Rt(t){return parseInt(Hn.appVersion)===t}function Bt(t,n){return function(e){return C(e)&&e>=t&&e<=n}}function Dt(t){return null!=t&&"[object BridgeTalk]"===f(t)}function Nt(t){return rn(t)||en(t)}function Ut(t){return fn(t)||Vt(t)}function Et(t){return b(We,t)}function Vt(t){return y(Te,t)}function Mt(t){return"dropdownlist"===t}function Xt(t){return A(Bt(0,3)(t),I(t)&&ee.test(t))}function Yt(t){return y(Le,t)}function _t(t){return t===qn}function Gt(t){return null!=t&&"[object global]"===f(t)}function qt(t){return null!=t&&"[object $]"===f(t)}function Ht(t){return I(t)&&oe.test(t)}function Jt(t){return ae===t}function Kt(t,n){return A(pn(t)&&!hn(n),hn(t)&&hn(n))}function Qt(t){return null===t||!t.visible}function Zt(t){return t.button===$e}function tn(t){return"listbox"===t}function nn(t){return Mt(t)||tn(t)}function en(t){return bn(t)||nn(t)}function rn(t){return Yt(t)||on(t)}function on(t){return b(ke,t)}function fn(t){return y(Ce,t)}function un(t){return"node"===t}function an(t){return"item"===t}function cn(t){return t instanceof Panel}function ln(t){return cn(t)}function sn(t){return t.button===Ie}function hn(t){return"tab"===t}function pn(t){return"tabbedpanel"===t}function dn(t){return"treeview"===t}function bn(t){return dn(t)||un(t)}function gn(t){return un(t)||an(t)}function vn(t,n){if(Kt(t,n))return!1;return yn(t,n)||mn(t,n)||On(t,n)}function yn(n,e){return t(rn(n),Yt(e)||Ut(e))}function xn(t){return _t(t)||ln(t)}function kn(t){return fn(t)||Nt(t)||an(t)||Vt(t)}function wn(t,n){return!!t&&b(n,t.appName)}function On(t,n){return nn(t)&&an(n)}function mn(t,n){return bn(t)&&gn(n)}function Sn(t){return t instanceof Window}function Cn(t){return De[t]}function Ln(t){return u(t,Re)}function Tn(t){return I(t)?ScriptUI.FontStyle[t.toUpperCase()]:t}function $n(t){return P(t,function(t,n){return b(je,n)&&!x(t)?D(4,d(t)):t})}function In(t){return r(t,function(t){return S(t)?void 0:t})}function zn(t){return r(n(M,null,V(u(t,Be))),function(t){var e=s(t,3),o=M(e[0],e[1]),i=r(o,function(t){return n(Wt,null,t)});return i.concat(e[2])})}function Pn(t,n,e){return t.add(n,e[1],e[2],e[3])}function Fn(t,n,e){return t.add(n,e[1],e[2],e[3],e[4],e[5])}function Wn(t,n){return t.add("item",n)}function An(t,n){return t.add("node",n)}function jn(t,n,e,r){return{text:this.newPen(this.PenType.SOLID_COLOR,t,1),fill:this.newBrush(this.BrushType.SOLID_COLOR,n),stroke:this.newPen(this.PenType.SOLID_COLOR,e,r)}}function Rn(){this.layout.resize()}function Bn(t){if(!L(t))return null;var e=n(ft,null,Dn(t,Bn));return ge.push(e),e}function Dn(t,n){var e=o(h(nr),Z(t)),r=!!e.show,i=!!e.dockable,f=!!e.singleton,u=Nn(n.context,i,f),a=En(n.layoutMode,e.layoutMode);return[f,t,u,r,a]}function Nn(t,n,e){if(e||!n)return Window;if(xn(Gn))return Gn;return xn(t)?t:Window}function Un(t,n){return Mn(Tt(t),n)}function En(t,n){if(Bt(0,2)(n))return n;if(Bt(0,2)(t))return t;return 0}function Vn(t,n){e(Fe,function(e){t.addEventListener(e,n)})}function Mn(t,n){var e=t[0];if(m(e))return t;var r=Lt(n),o=t[r];if(L(o)||(t[r]={}),y(o,"name"))return t;return t[r].name=e,t}function Xn(t){return t.addEventListener("mouseup",function(n){n.stopPropagation(),w(t.onClick)&&Zt(n)&&t.onClick()}),t}function Yn(t,n){return Vn(t,function(e){if(e.stopPropagation(),sn(e))return;t.graphics.pen=n[e.type],t.notify("onDraw")}),t}function _n(t){var n=String(t[0]);return t[0]=b(Oe,n)?n:Se,t}var Gn=this,qn=qt($)&&Gt($.global)&&$.global,Hn=!!qn&&Dt(qn.BridgeTalk)&&qn.BridgeTalk,Jn=["aftereffects","photoshop","illustrator","indesign","estoolkit"];if(!wn(Hn,Jn))throw"不受支持的宿主应用";var Kn="0.2.4",Qn=1/0,Zn=/\d/g,te=/\\(\\)?/g,ne=/\)$|^\(/g,ee=/REGULAR|BOLD|ITALIC|BOLDITALIC/i,re=/^#?([a-f\d])([a-f\d])([a-f\d])$/gi,oe=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/gi,ie=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fe=/^\w*$/,ue=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ae=Hn.appName,ce=Jt("aftereffects"),le=Jt("photoshop"),se=Jt("illustrator"),he=Jt("indesign"),pe=Jt("estoolkit"),de=ce&&Rt(16),be=se||he,ge=[],ve=le?1:0,ye=se?4.5:5,xe=2.4,ke=["palette","dialog","window"],we={aftereffects:["dialog","palette","window"],photoshop:"dialog",illustrator:["dialog","palette","window"],indesign:"dialog",estoolkit:["dialog","palette","window"]},Oe=we[ae],me={aftereffects:"palette",photoshop:"dialog",illustrator:"palette",indesign:"dialog",estoolkit:"palette"},Se=me[ae],Ce={button:3,checkbox:3,dropdownlist:3,edittext:3,iconbutton:3,image:3,listbox:3,progressbar:5,radiobutton:3,scrollbar:5,slider:5,statictext:3,treeview:3},Le={group:2,panel:3,tab:3,tabbedpanel:3},Te={rectbutton:3,roundbutton:3,angle:3};le&&E(Ce,"treeview"),pe&&o(Ce,{flashplayer:3});var $e=0,Ie=2,ze=["enableText","enableFill","enableStroke","fontName","fontStyle","fontSize","fontOffset","fontColor","fillColor","strokeColor","fontOpacity","fillOpacity","strokeOpacity","strokeWidth"],Pe=ze,Fe=["mouseover","mouseout","mousedown","mouseup"],We=["rectbutton","roundbutton"],Ae=["enableText","enableFill","enableStroke","fontOffset"],je=["fontColor","fillColor","strokeColor","fontOpacity","fillOpacity","strokeOpacity","strokeWidth"],Re=["fontName","fontStyle","fontSize"],Be=["fontColor","fillColor","strokeColor","fontOpacity","fillOpacity","strokeOpacity","strokeWidth"],De={rectbutton:"customView",roundbutton:"customView",angle:"customBoundedValue"},Ne={aftereffects:2,photoshop:1,illustrator:2,indesign:2,estoolkit:2},Ue=D(4,d(Ne[ae])),Ee={aftereffects:[0,0],photoshop:[0,0],illustrator:[0,2],indesign:[0,3],estoolkit:[0,-1]},Ve=Ee[ae],Me={aftereffects:["#161616","#8a8a8a","#161616","#ffffff"],photoshop:["#f0f0f0","#f0f0f0","#f0f0f0","#ffffff"],illustrator:["#4b4b4b","#ffffff","#ffffff","#ffffff"],indesign:["#4b4b4b","#ffffff","#ffffff","#ffffff"],estoolkit:["#000000","#000000","#000000","#000000"]},Xe=Me[ae],Ye={aftereffects:["#8a8a8a","#232323","#636363","#2d8ceb"],photoshop:["#454545","#454545","#363636","#454545"],illustrator:["#ffffff","#535353","#46a0f5","#46a0f5"],indesign:["#ffffff","#535353","#46a0f5","#46a0f5"],estoolkit:["#e5f1fb","#e1e1e1","#cce4f7","#e5f1fb"]},_e=Ye[ae],Ge={aftereffects:["#8a8a8a","#8a8a8a","#636363","#2d8ceb"],photoshop:["#666666","#666666","#636363","#1473e7"],illustrator:["#ffffff","#ffffff","#46a0f5","#46a0f5"],indesign:["#ffffff","#ffffff","#46a0f5","#46a0f5"],estoolkit:["#0078d7","#adadad","#005499","#0078d7"]},qe=Ge[ae],He={aftereffects:[0,0,80,28],photoshop:[0,0,65,25],illustrator:[0,0,80,26],indesign:[0,0,80,28],estoolkit:[0,0,78,23]},Je=He[ae],Ke={aftereffects:[0,0,30,30],photoshop:[0,0,28,28],illustrator:[0,0,28,28],indesign:[0,0,30,30],estoolkit:[0,0,23,23]},Qe=Ke[ae],Ze={text:"",bounds:Je},tr={text:"",bounds:Qe},nr={dockable:!0,show:!0,singleton:!1},er={enableText:!0,enableFill:!0,enableStroke:!0,fontName:"Tahoma",fontStyle:"REGULAR",fontSize:12,fontOffset:[0,0],fontColor:Xe,fillColor:_e,strokeColor:qe,fontOpacity:[1,1,1,1],fillOpacity:[1,1,1,1],strokeOpacity:[1,1,1,1],strokeWidth:Ue},rr=er,or={enableText:k,enableFill:k,enableStroke:k,fontName:I,fontStyle:Xt,fontSize:Bt(1,24),fontOffset:[C,C],fontColor:[Ht,Ht,Ht,Ht],fillColor:[Ht,Ht,Ht,Ht],strokeColor:[Ht,Ht,Ht,Ht],fontOpacity:[Bt(0,1),Bt(0,1),Bt(0,1),Bt(0,1)],fillOpacity:[Bt(0,1),Bt(0,1),Bt(0,1),Bt(0,1)],strokeOpacity:[Bt(0,1),Bt(0,1),Bt(0,1),Bt(0,1)],strokeWidth:[Bt(0,10),Bt(0,10),Bt(0,10),Bt(0,10)]},ir=or;return Bn.version=Kn,Bn}.call(this);
